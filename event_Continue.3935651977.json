{
	"type": "EVENT_BUTTON",
	"name": "Continue",
	"serverCode": "// Put your code here.\n\n$sql = DB::PrepareSQL(\"select CustomerID from customers where CustomerID = ':1'\", $params[\"username\"]);\n$id = DB::DBLookup($sql);\nif ($id) {\n    $result[\"message\"]=\"\";\n    $_SESSION[\"CustomerID\"] = $id;\n    \n    // pull random questions from the database\n    \n    \n    $sql = DB::PrepareSQL(\"select id from customers where CustomerID=':1'\", $_SESSION[\"CustomerID\"]);\n    $userid = DB::DBLookup($sql);\n    \n    $sql = DB::PrepareSQL(\"SELECT * FROM users_answers a inner join questions q on a.questionid = q.id \n    where userid = :1 ORDER BY RAND() LIMIT 2\", $userid);\n\n    $i=1;\n\n    $rs = DB::Query($sql);\n     \n    while( $data = $rs->fetchAssoc() )\n    {\n        $result[\"question\".$i] = $data[\"question\"];\n        $_SESSION[\"answer\".$i] = $data[\"answer\"]; \n    \n        $i++;\n    }\n    \n    \n} else {\n    $result[\"message\"]=\"Username doesn't exist\";\n    $_SESSION[\"CustomerID\"] = \"\";\n}\n\n",
	"beforeJsCode": "// Put your code here.\n\najax.setMessage(\"\");\nvar username = Runner.getControl(1, 'username');\nparams[\"username\"] = username.getValue();\n\n // Uncomment the following line to prevent execution of \"Server\" and \"Client After\" events.\n // return false;",
	"afterJsCode": "// Put your code here.\n\nif (result[\"message\"]!=\"\") {\n    ajax.setMessage(result[\"message\"]);\n} else {\n    // username exists\n    // show question1, question2, password fields\n    pageObj.toggleItem(\"question1\", true );\n    pageObj.toggleItem(\"question2\", true );\n    pageObj.toggleItem(\"password\", true );\n    pageObj.toggleItem(\"add_save\", true );\n    \n    // change labels of question fields\n    $(\"label[for^='value_question1']\").text(result[\"question1\"]);\n    $(\"label[for^='value_question2']\").text(result[\"question2\"]);\n}\n    \n"
}